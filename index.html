<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualización de Datos - PEC 2</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        
        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .visualization-section {
            background: white;
            margin: 2rem 0;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .visualization-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .visualization-section h2 {
            color: #667eea;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid #667eea;
        }
        
        /* Contenedor para el iframe */
        .visualization-container {
            width: 100%;
            height: 600px;
            margin: 1.5rem 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            background: #fff;
            position: relative;
        }
        
        .visualization-container iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }

        .visualization-container img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: none;
        }

        .visualization-container.show-image iframe {
            display: none;
        }

        .visualization-container.show-image img {
            display: block;
        }
        
        /* Botón para ver en pantalla completa */
        .fullscreen-btn {
            display: inline-block;
            margin: 1rem 0;
            padding: 0.5rem 1rem;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background 0.3s ease;
        }
        
        .fullscreen-btn:hover {
            background: #764ba2;
        }
        
        .description {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            margin: 1rem 0;
        }
        
        .description h3 {
            color: #555;
            margin-bottom: 0.5rem;
        }
        
        .interpretation {
            background: #e8f4f8;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid #764ba2;
            margin: 1rem 0;
        }
        
        .interpretation h3 {
            color: #555;
            margin-bottom: 0.5rem;
        }
        
        footer {
            text-align: center;
            padding: 2rem;
            background: #333;
            color: white;
            margin-top: 3rem;
        }
        
        footer a {
            color: #667eea;
            text-decoration: none;
        }
        
        footer a:hover {
            text-decoration: underline;
        }

        /* Loading placeholder */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 600px;
            background: #f0f0f0;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Visualización de Datos - PEC 2</h1>
        <p>Análisis y representaciones gráficas de datos</p>
    </header>

    <div class="container">
        <!-- Visualización 1: Pie Chart -->
        <section class="visualization-section">
            <h2>1. Gráfico de Pastel (Pie Chart)</h2>
            
            <div class="visualization-container" id="viz1">
                <iframe src="Visualizaciones/pie_chart.html" title="Gráfico de Pastel" onload="checkIframeLoad(this)" onerror="showFallbackImage('viz1')"></iframe>
                <img src="Visualizaciones/pie_chart.png" alt="Gráfico de Pastel">
            </div>
            <a href="Visualizaciones/pie_chart.html" target="_blank" class="fullscreen-btn">Ver en pantalla completa</a>
            
            <div class="description">
                <h3>Descripción</h3>
                <p>El **pie chart**, introducido por *William Playfair* en 1801 y popularizado por *Florence Nightingale*, representa un conjunto de categorías como sectores proporcionales de un círculo.
                   Cada sector muestra la **participación relativa** de una categoría respecto al total. 
                   Se calculó el **volumen medio** negociado por empresa y se representó con un **gráfico de donut** (variación moderna del pie chart) usando Plotly.</p>
            </div>
            
            <div class="interpretation">
                <h3>Interpretación</h3>
                <p>El gráfico muestra que **Apple** concentra aproximadamente un **56 % del volumen medio total**, mientras que **Microsoft** y **Google** suman el resto.
                   Esto refleja **mayor liquidez y actividad bursátil** en Apple.
                   El objetivo es ofrecer una visión clara y rápida de la **proporción de mercado** de cada empresa.</p>
            </div>
        </section>

        <!-- Visualización 2: CandleSticks -->
        <section class="visualization-section">
            <h2>2. Gráfico de Velas (CandleSticks)</h2>
            
            <div class="visualization-container" id="viz2">
                <iframe src="Visualizaciones/CandleSticks.html" title="Gráfico de Velas" onload="checkIframeLoad(this)" onerror="showFallbackImage('viz2')"></iframe>
                <img src="Visualizaciones/CandleSticks.png" alt="Gráfico de Velas">
            </div>
            <a href="Visualizaciones/CandleSticks.html" target="_blank" class="fullscreen-btn">Ver en pantalla completa</a>
            
            <div class="description">
                <h3>Descripción</h3>
                <p>Desarrollado en el siglo XVIII por el comerciante japonés **Munehisa Homma** y popularizado por **Steve Nison** en 1991, el **candlestick chart** representa la **evolución temporal del precio** de un activo mediante velas con los valores **OHLC** (Open, High, Low, Close).
                   Con Plotly Graph Objects se graficaron las velas de las tres empresas junto con sus medias móviles
                </p>
            </div>
            
            <div class="interpretation">
                <h3>Interpretación</h3>
                <p>El gráfico muestra la **evolución diaria de precios entre 2023 y 2024**.
                   Se observan **tendencias alcistas**, con **mayor volatilidad en Apple**, cuyos cuerpos de vela son más amplios.
                   Las medias móviles ayudan a detectar fases de consolidación y cambios de tendencia.
                   El objetivo comunicativo es **mostrar de forma dinámica la evolución histórica y comparativa de precios**.</p>
            </div>
        </section>

        <!-- Visualización 3: Convex Hull -->
        <section class="visualization-section">
            <h2>3. Envolvente Convexa (Convex Hull)</h2>
            
            <div class="visualization-container" id="viz3">
                <iframe src="Visualizaciones/convex_hull.html" title="Convex Hull" onload="checkIframeLoad(this)" onerror="showFallbackImage('viz3')"></iframe>
                <img src="Visualizaciones/convex_hull.png" alt="Convex Hull">
            </div>
            <a href="Visualizaciones/convex_hull.html" target="_blank" class="fullscreen-btn">Ver en pantalla completa</a>
            
            <div class="description">
                <h3>Descripción</h3>
                <p>La **envolvente convexa** o *Convex Hull* es un concepto de **geometría computacional** que forma el **polígono convexo mínimo** que contiene un conjunto de puntos.
                   Imaginemos una goma elástica rodeando los puntos: esa forma es la envolvente Se calculó con `scipy.spatial.ConvexHull` y se visualizó con Plotly, mostrando los puntos y la envolvente por empresa.
                   Cada área coloreada delimita el **espacio de variabilidad de precios**.</p>
            </div>
            
            <div class="interpretation">
                <h3>Interpretación</h3>
                <p>Las envolventes permiten comparar la **dispersión y estabilidad** de las acciones:

                    * **Apple:** envolvente más estrecha → menor volatilidad
                    * **Microsoft:** mayor dispersión → más riesgo
                    * **Google:** comportamiento intermedio
                                    
                    La técnica permite identificar **límites de comportamiento y valores anómalos**, siendo útil para análisis exploratorios y financieros.</p>
            </div>
        </section>
    </div>

    <footer>
        <p>Proyecto realizado para la PEC 2 de Visualización de Datos</p>
        <p><a href="https://github.com/JulioUQ/Visualizacion_de_Datos_PEC-2" target="_blank">Ver en GitHub</a></p>
    </footer>

    <script>
        // Función para verificar si el iframe cargó correctamente
        function checkIframeLoad(iframe) {
            try {
                // Intentar acceder al contenido del iframe
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                
                // Si el iframe está vacío o tiene error, mostrar imagen
                if (!iframeDoc || iframeDoc.body.children.length === 0) {
                    showFallbackImage(iframe.parentElement.id);
                }
            } catch (e) {
                // Si hay error de acceso (CORS, etc.), mostrar imagen
                showFallbackImage(iframe.parentElement.id);
            }
        }

        // Función para mostrar la imagen de respaldo
        function showFallbackImage(containerId) {
            const container = document.getElementById(containerId);
            if (container) {
                container.classList.add('show-image');
            }
        }

        // Timeout de seguridad: después de 3 segundos, verificar si los iframes cargaron
        setTimeout(() => {
            document.querySelectorAll('.visualization-container iframe').forEach(iframe => {
                checkIframeLoad(iframe);
            });
        }, 3000);

        // Verificar cuando la página termine de cargar
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.querySelectorAll('.visualization-container iframe').forEach(iframe => {
                    checkIframeLoad(iframe);
                });
            }, 1000);
        });
    </script>
</body>
</html>